# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Telegram ‚Üí Kira

**–î–∞—Ç–∞**: 2025-10-10
**–ê–≤—Ç–æ—Ä**: AI Assistant
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω + üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

---

## üìä Executive Summary

**–û–±—â–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞**: 15-25 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å
**–û—Å–Ω–æ–≤–Ω–æ–µ —É–∑–∫–æ–µ –º–µ—Å—Ç–æ**: LLM –≤—ã–∑–æ–≤—ã (97% –≤—Ä–µ–º–µ–Ω–∏)
**–¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å**: Google Gemini 2.5 Flash —á–µ—Ä–µ–∑ OpenRouter
**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–∞–π–ø–ª–∞–π–Ω–∞

### –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∑–∞–ø—Ä–æ—Å–∞ (Telegram ‚Üí Kira ‚Üí –û—Ç–≤–µ—Ç)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ TELEGRAM INPUT                                                   ‚îÇ
‚îÇ User: "–ü–æ–∫–∞–∂–∏ –º–æ–∏ –∑–∞–¥–∞—á–∏"                                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ <0.01s - network latency
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ADAPTER LAYER                                                    ‚îÇ
‚îÇ TelegramAdapter (long polling)                                  ‚îÇ
‚îÇ ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ whitelist         <0.001s                          ‚îÇ
‚îÇ ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏   <0.001s                          ‚îÇ
‚îÇ ‚îú‚îÄ –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è         <0.001s                          ‚îÇ
‚îÇ ‚îî‚îÄ –û—Ç–ø—Ä–∞–≤–∫–∞ "–î—É–º–∞—é."          ~0.2s (API call)                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ <0.001s - in-process event bus
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ MESSAGE HANDLER                                                  ‚îÇ
‚îÇ MessageHandler.handle_message()                                 ‚îÇ
‚îÇ ‚îî‚îÄ –í—ã–∑–æ–≤ UnifiedExecutor      <0.001s                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ <0.001s
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ UNIFIED EXECUTOR                                                 ‚îÇ
‚îÇ UnifiedExecutor.chat_and_execute()                              ‚îÇ
‚îÇ ‚îú‚îÄ –ó–∞–≥—Ä—É–∑–∫–∞ conversation memory  <0.01s (SQLite)               ‚îÇ
‚îÇ ‚îî‚îÄ –í—ã–∑–æ–≤ LangGraphExecutor       <0.001s                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ <0.001s
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ LANGGRAPH EXECUTOR                                               ‚îÇ
‚îÇ LangGraphExecutor.execute()                                     ‚îÇ
‚îÇ ‚îî‚îÄ –ó–∞–ø—É—Å–∫ graph.invoke()      <0.001s                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ <0.001s
                 ‚ñº
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –£–ó–ö–û–ï –ú–ï–°–¢–û: LANGGRAPH NODES                     ‚ïë
‚ïë (97% –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)                                 ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ CYCLE 1: Planning + Execution               ‚îÇ
    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
    ‚îÇ 1. plan_node                                ‚îÇ
    ‚îÇ    ‚îî‚îÄ LLM call (planning)      ~3.6s ‚ö†Ô∏è    ‚îÇ
    ‚îÇ                                              ‚îÇ
    ‚îÇ 2. reflect_node                             ‚îÇ
    ‚îÇ    ‚îî‚îÄ LLM call (safety)        ~4.2s üî¥    ‚îÇ
    ‚îÇ                                              ‚îÇ
    ‚îÇ 3. tool_node                                ‚îÇ
    ‚îÇ    ‚îî‚îÄ task_list execution      ~0.01s ‚úÖ   ‚îÇ
    ‚îÇ                                              ‚îÇ
    ‚îÇ 4. verify_node                              ‚îÇ
    ‚îÇ    ‚îî‚îÄ Result validation        <0.01s ‚úÖ   ‚îÇ
    ‚îÇ                                              ‚îÇ
    ‚îÇ Total Cycle 1:                 ~7.8s        ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ Dynamic replanning
                 ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ CYCLE 2: Re-planning (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã –µ—â—ë —à–∞–≥–∏) ‚îÇ
    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
    ‚îÇ 5. plan_node                                ‚îÇ
    ‚îÇ    ‚îî‚îÄ LLM call                 ~3.6s ‚ö†Ô∏è    ‚îÇ
    ‚îÇ                                              ‚îÇ
    ‚îÇ 6. reflect_node                             ‚îÇ
    ‚îÇ    ‚îî‚îÄ LLM call                 ~4.2s üî¥    ‚îÇ
    ‚îÇ                                              ‚îÇ
    ‚îÇ 7. tool_node (empty plan)                   ‚îÇ
    ‚îÇ    ‚îî‚îÄ No execution             <0.01s       ‚îÇ
    ‚îÇ                                              ‚îÇ
    ‚îÇ Total Cycle 2:                 ~7.8s        ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 8. respond_node                             ‚îÇ
    ‚îÇ    ‚îî‚îÄ LLM call (NL response)   ~3.5s ‚ö†Ô∏è    ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

    Total LangGraph time: 15.6-23.4 seconds
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ RESPONSE HANDLING                                                ‚îÇ
‚îÇ ‚îú‚îÄ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ memory        <0.01s                            ‚îÇ
‚îÇ ‚îú‚îÄ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞      <0.001s                           ‚îÇ
‚îÇ ‚îî‚îÄ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram        ~0.2s (API call)                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ TELEGRAM OUTPUT                                                  ‚îÇ
‚îÇ Bot: "–í–æ—Ç —Ç–≤–æ–∏ —Ç–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏:..."                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–û–ë–©–ï–ï –í–†–ï–ú–Ø: 15-25 —Å–µ–∫—É–Ω–¥
```

---

## üìà –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –î–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ ("–ü–æ–∫–∞–∂–∏ –º–æ–∏ –∑–∞–¥–∞—á–∏")

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í—Ä–µ–º—è (—Å–µ–∫) | % –æ—Ç –æ–±—â–µ–≥–æ | –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ | –ú–æ–∂–Ω–æ –ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å? |
|-----------|-------------|-------------|--------------|--------------------------|
| **Telegram API** | 0.2 | 1% | Network I/O | ‚ùå –ó–∞–≤–∏—Å–∏—Ç –æ—Ç Telegram |
| **Adapter + EventBus** | <0.01 | <0.1% | In-process | ‚úÖ –£–∂–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ |
| **MessageHandler** | <0.01 | <0.1% | In-process | ‚úÖ –£–∂–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ |
| **Memory load/save** | <0.02 | <0.1% | SQLite I/O | ‚úÖ –£–∂–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ |
| **plan_node (LLM)** | 3.6 | 23% | OpenRouter API | ‚ö†Ô∏è –ú–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å |
| **reflect_node (LLM)** | 4.2 | 27% | OpenRouter API | üî¥ –ö–†–ò–¢–ò–ß–ù–û! |
| **tool_node** | 0.01 | <0.1% | Local execution | ‚úÖ –£–∂–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ |
| **verify_node** | <0.01 | <0.1% | Local validation | ‚úÖ –£–∂–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ |
| **plan_node (2nd cycle)** | 3.6 | 23% | OpenRouter API | ‚ö†Ô∏è –ú–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å |
| **reflect_node (2nd cycle)** | 4.2 | 27% | OpenRouter API | üî¥ –ö–†–ò–¢–ò–ß–ù–û! |
| **respond_node (LLM)** | 3.5 | 22% | OpenRouter API | ‚ö†Ô∏è –ú–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å |
| **Response formatting** | <0.01 | <0.1% | In-process | ‚úÖ –£–∂–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ |
| **–ò–¢–û–ì–û** | **15.6** | **100%** | | |

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **LLM –≤—ã–∑–æ–≤—ã –∑–∞–Ω–∏–º–∞—é—Ç 97% –≤—Ä–µ–º–µ–Ω–∏** (15.1 –∏–∑ 15.6 —Å–µ–∫—É–Ω–¥)
2. **Reflection —Å–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π —É–∑–µ–ª** (4.2s √ó 2 cycles = 8.4s, –∏–ª–∏ 54% –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏!)
3. **Dynamic replanning —É–¥–≤–∞–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ LLM –≤—ã–∑–æ–≤–æ–≤**
4. **–õ–æ–∫–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ** (tool execution, validation)

---

## üîß –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### LLM Provider & Model

```bash
# –ò–∑ .env
LLM_PROVIDER=openrouter
OPENROUTER_DEFAULT_MODEL=google/gemini-2.5-flash

# Routing (–≤—Å–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç OpenRouter)
ROUTER_PLANNING_PROVIDER=openrouter
ROUTER_STRUCTURING_PROVIDER=openrouter
ROUTER_DEFAULT_PROVIDER=openrouter
```

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ Gemini 2.5 Flash

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û—Ü–µ–Ω–∫–∞ |
|----------|----------|--------|
| **–°–∫–æ—Ä–æ—Å—Ç—å** | ~3-4s –Ω–∞ –∑–∞–ø—Ä–æ—Å | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è |
| **–ö–∞—á–µ—Å—Ç–≤–æ** | –•–æ—Ä–æ—à–µ–µ | ‚úÖ |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å** | $0.075/$0.30 per 1M tokens | ‚úÖ –î–µ—à–µ–≤–æ |
| **Context window** | 1M tokens | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| **Latency** | Network + API processing | ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ—Ç–∏ |

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è LangGraph

```python
# –ò–∑ AgentConfig
enable_langgraph_reflection: bool = True  # üî¥ –í–ö–õ–Æ–ß–ï–ù–û
enable_langgraph_verification: bool = True  # ‚úÖ OK (–±—ã—Å—Ç—Ä–æ)
langgraph_max_steps: int = 10  # ‚úÖ OK
```

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. üî¥ –ö–†–ò–¢–ò–ß–ù–û: –û—Ç–∫–ª—é—á–∏—Ç—å Reflection –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞**: Reflection –¥–æ–±–∞–≤–ª—è–µ—Ç 4.2s √ó N —Ü–∏–∫–ª–æ–≤ (–≥–¥–µ N = 2-3), —á—Ç–æ –¥–∞—ë—Ç **8-12 —Å–µ–∫—É–Ω–¥** –ª–∏—à–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

**–†–µ—à–µ–Ω–∏–µ**: –£—Å–ª–æ–≤–Ω—ã–π Reflection

```yaml
# kira.yaml - –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å–µ–∫—Ü–∏—é
agent:
  reflection:
    mode: "conditional"  # always | conditional | never
    enable_for_operations:
      - task_delete       # –î–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
      - task_update       # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
      - file_delete       # –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
      - external_api      # –í–Ω–µ—à–Ω–∏–µ API
    disable_for_operations:
      - task_list         # –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
      - task_get          # –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
      - search            # –ü–æ–∏—Å–∫
      - query             # –ó–∞–ø—Ä–æ—Å—ã
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è** (–≤ `src/kira/agent/graph.py`):

```python
def route_after_plan(state):
    """Route after planning."""
    if state.error or state.status == "error":
        return "respond_step"
    if state.status == "completed":
        return "respond_step"

    # üÜï Conditional reflection based on operation type
    if state.flags.enable_reflection:
        # Check if any tool in plan is destructive
        destructive_tools = {"task_delete", "task_update", "file_delete"}
        planned_tools = {step.get("tool") for step in state.plan}

        if planned_tools & destructive_tools:
            return "reflect_step"  # Safety check needed
        else:
            logger.info(f"[{state.trace_id}] Skipping reflection for read-only operations")
            return "tool_step"  # Skip reflection for read-only

    return "tool_step"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: **–≠–∫–æ–Ω–æ–º–∏—è 8-12 —Å–µ–∫—É–Ω–¥** (50-75% –≤—Ä–µ–º–µ–Ω–∏!) –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Ç–∏–ø–∞ "–ø–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á–∏", "–Ω–∞–π–¥–∏", "—á—Ç–æ —É –º–µ–Ω—è —Å–µ–≥–æ–¥–Ω—è"

---

### 2. ‚ö†Ô∏è –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é –º–æ–¥–µ–ª—å –¥–ª—è Planning

**–ü—Ä–æ–±–ª–µ–º–∞**: Gemini 2.5 Flash —Ö–æ—Ä–æ—à, –Ω–æ –µ—Å—Ç—å –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ**: –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ - –±—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å –¥–ª—è planning, —É–º–Ω–∞—è –¥–ª—è reflection

#### –í–∞—Ä–∏–∞–Ω—Ç A: Claude Haiku (–µ—Å–ª–∏ –µ—Å—Ç—å Anthropic API key)

```bash
# .env
ANTHROPIC_API_KEY=sk-ant-...
ANTHROPIC_DEFAULT_MODEL=claude-3-5-haiku-20241022

# Routing
ROUTER_PLANNING_PROVIDER=anthropic     # ‚Üê –ë—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
ROUTER_STRUCTURING_PROVIDER=openrouter # ‚Üê –û—Å—Ç–∞–≤–∏—Ç—å Gemini
ROUTER_DEFAULT_PROVIDER=openrouter
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ Claude 3.5 Haiku**:
- –°–∫–æ—Ä–æ—Å—Ç—å: ~1.5-2s (–Ω–∞ 40% –±—ã—Å—Ç—Ä–µ–µ Gemini Flash)
- –ö–∞—á–µ—Å—Ç–≤–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: –û—Ç–ª–∏—á–Ω–æ–µ
- –°—Ç–æ–∏–º–æ—Å—Ç—å: $0.80/$4.00 per 1M tokens (–¥–æ—Ä–æ–∂–µ, –Ω–æ –±—ã—Å—Ç—Ä–µ–µ)

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: **–≠–∫–æ–Ω–æ–º–∏—è ~2-3 —Å–µ–∫—É–Ω–¥—ã** –Ω–∞ –∫–∞–∂–¥–æ–º planning –≤—ã–∑–æ–≤–µ

#### –í–∞—Ä–∏–∞–Ω—Ç B: GPT-4o Mini (–µ—Å–ª–∏ –µ—Å—Ç—å OpenAI API key)

```bash
# .env
OPENAI_API_KEY=sk-...
OPENAI_DEFAULT_MODEL=gpt-4o-mini

ROUTER_PLANNING_PROVIDER=openai
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ GPT-4o Mini**:
- –°–∫–æ—Ä–æ—Å—Ç—å: ~2-3s (—Å—Ö–æ–∂–µ —Å Gemini)
- –ö–∞—á–µ—Å—Ç–≤–æ: –û—á–µ–Ω—å —Ö–æ—Ä–æ—à–µ–µ
- –°—Ç–æ–∏–º–æ—Å—Ç—å: $0.15/$0.60 per 1M tokens (–¥–µ—à–µ–≤–ª–µ Haiku)

---

### 3. üÜï –≠–ö–°–ü–ï–†–ò–ú–ï–ù–¢: –õ–æ–∫–∞–ª—å–Ω–∞—è LLM –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –ø–ª–∞–Ω–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞**: –°–µ—Ç–µ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ OpenRouter/Anthropic/OpenAI –¥–æ–±–∞–≤–ª—è–µ—Ç 1-2s –∫ –∫–∞–∂–¥–æ–º—É –∑–∞–ø—Ä–æ—Å—É

**–†–µ—à–µ–Ω–∏–µ**: Ollama –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, OpenRouter –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö

```yaml
# kira.yaml
agent:
  llm_routing:
    use_local_for_simple: true
    simple_patterns:
      - "–ø–æ–∫–∞–∂–∏.*–∑–∞–¥–∞—á"
      - "—Å–ø–∏—Å–æ–∫.*–∑–∞–¥–∞—á"
      - "—á—Ç–æ.*—Å–µ–≥–æ–¥–Ω—è"
      - "–Ω–∞–π–¥–∏"
    local_model: "llama3.2:3b"  # –ë—ã—Å—Ç—Ä–∞—è –∏ –ª—ë–≥–∫–∞—è –º–æ–¥–µ–ª—å
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama
curl -fsSL https://ollama.com/install.sh | sh

# –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
ollama pull llama3.2:3b  # 2GB, –±—ã—Å—Ç—Ä–∞—è
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ Ollama (Llama 3.2 3B)**:
- –°–∫–æ—Ä–æ—Å—Ç—å: ~0.5-1s (–≤ 3-4 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ!)
- –ö–∞—á–µ—Å—Ç–≤–æ: –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –°—Ç–æ–∏–º–æ—Å—Ç—å: $0 (–ª–æ–∫–∞–ª—å–Ω–æ)
- Latency: –ù–µ—Ç —Å–µ—Ç–µ–≤–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: **–≠–∫–æ–Ω–æ–º–∏—è 2-3 —Å–µ–∫—É–Ω–¥—ã** –Ω–∞ –∫–∞–∂–¥–æ–º LLM –≤—ã–∑–æ–≤–µ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

### 4. üí° –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞**: –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è –≤ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å prompt caching (–µ—Å–ª–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)

```python
# src/kira/adapters/llm/openrouter.py
def chat(self, messages, **kwargs):
    # Add cache control for system prompts
    if messages[0].role == "system":
        # OpenRouter + Anthropic support prompt caching
        headers = {
            "HTTP-Referer": "https://github.com/kira-project",
            "anthropic-beta": "prompt-caching-2024-07-31"  # Enable caching
        }
        kwargs["extra_headers"] = headers

        # Mark system prompt for caching
        messages[0].cache_control = {"type": "ephemeral"}

    return super().chat(messages, **kwargs)
```

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**:
- ‚úÖ Anthropic Claude (–≤—Å–µ –º–æ–¥–µ–ª–∏)
- ‚ùå Google Gemini (–ø–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)
- ‚ö†Ô∏è OpenAI (—Ç–æ–ª—å–∫–æ –¥–ª—è batch API)

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: **–≠–∫–æ–Ω–æ–º–∏—è 10-20% –≤—Ä–µ–º–µ–Ω–∏** –Ω–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –ø—Ä–æ–º–ø—Ç–∞—Ö

---

### 5. üîß –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ LLM –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö tool calls, –æ–Ω–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ

**–†–µ—à–µ–Ω–∏–µ**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ `tool_node`

```python
# src/kira/agent/nodes.py - tool_node()
import asyncio

def tool_node(state: AgentState, tool_registry: ToolRegistry):
    # Check if tools are independent (no shared dependencies)
    if len(state.plan) > 1 and all_independent(state.plan):
        # Execute in parallel
        results = await asyncio.gather(
            *[execute_tool_async(step, tool_registry) for step in state.plan]
        )
    else:
        # Execute sequentially
        results = [execute_tool(step, tool_registry) for step in state.plan]

    return {"tool_results": results}
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: **–≠–∫–æ–Ω–æ–º–∏—è 30-50% –≤—Ä–µ–º–µ–Ω–∏** –¥–ª—è multi-tool –ø–ª–∞–Ω–æ–≤ (—Ä–µ–¥–∫–æ, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ)

---

### 6. üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ alerting

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç visibility –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
# src/kira/agent/nodes.py - –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–∞–∂–¥—ã–π node
import time

def plan_node(state, llm_adapter, tools_description):
    start_time = time.time()

    # ... existing code ...

    duration = time.time() - start_time
    logger.info(
        f"[{state.trace_id}] ‚è±Ô∏è plan_node completed in {duration:.2f}s",
        extra={
            "duration_seconds": duration,
            "node": "plan_node",
            "trace_id": state.trace_id,
        }
    )

    # Alert if too slow
    if duration > 5.0:
        logger.warning(f"[{state.trace_id}] ‚ö†Ô∏è plan_node exceeded 5s threshold: {duration:.2f}s")

    return result
```

---

## üìã –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º)

### üî¥ –ö–†–ò–¢–ò–ß–ù–û (—Å–¥–µ–ª–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ)

1. **–û—Ç–∫–ª—é—á–∏—Ç—å Reflection –¥–ª—è read-only –æ–ø–µ—Ä–∞—Ü–∏–π**
   - –§–∞–π–ª—ã: `src/kira/agent/graph.py`
   - –≠—Ñ—Ñ–µ–∫—Ç: -8-12s (50-75% —É—Å–∫–æ—Ä–µ–Ω–∏–µ)
   - –°–ª–æ–∂–Ω–æ—Å—Ç—å: –ù–∏–∑–∫–∞—è (30 –º–∏–Ω—É—Ç)
   - –†–∏—Å–∫: –ù–∏–∑–∫–∏–π (read-only –æ–ø–µ—Ä–∞—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã)

### ‚ö†Ô∏è –í–ê–ñ–ù–û (—Å–¥–µ–ª–∞—Ç—å –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ)

2. **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**
   - –§–∞–π–ª—ã: `src/kira/agent/nodes.py`
   - –≠—Ñ—Ñ–µ–∫—Ç: Visibility
   - –°–ª–æ–∂–Ω–æ—Å—Ç—å: –ù–∏–∑–∫–∞—è (1 —á–∞—Å)

3. **–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å Claude 3.5 Haiku –¥–ª—è planning**
   - –§–∞–π–ª—ã: `.env`, `config/defaults.yaml`
   - –≠—Ñ—Ñ–µ–∫—Ç: -2-3s –Ω–∞ planning
   - –°–ª–æ–∂–Ω–æ—Å—Ç—å: –û—á–µ–Ω—å –Ω–∏–∑–∫–∞—è (5 –º–∏–Ω—É—Ç)
   - –°—Ç–æ–∏–º–æ—Å—Ç—å: –¢—Ä–µ–±—É–µ—Ç Anthropic API key

### üí° –≠–ö–°–ü–ï–†–ò–ú–ï–ù–¢ (–ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å, –µ—Å–ª–∏ –≤—Ä–µ–º—è –µ—Å—Ç—å)

4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Ollama –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**
   - –≠—Ñ—Ñ–µ–∫—Ç: -2-3s –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã
   - –°–ª–æ–∂–Ω–æ—Å—Ç—å: –°—Ä–µ–¥–Ω—è—è (2-3 —á–∞—Å–∞)
   - –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å 4GB RAM

5. **Implement prompt caching**
   - –≠—Ñ—Ñ–µ–∫—Ç: -10-20% –≤—Ä–µ–º–µ–Ω–∏
   - –°–ª–æ–∂–Ω–æ—Å—Ç—å: –°—Ä–µ–¥–Ω—è—è (2 —á–∞—Å–∞)
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å Anthropic

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (baseline)

| –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ | –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è | –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ |
|-------------|---------------|-------------------|
| "–ü–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á–∏" | 15-18s | task_list (read-only) |
| "–£–¥–∞–ª–∏ –∑–∞–¥–∞—á—É X" | 20-25s | task_list + task_delete |
| "–°–æ–∑–¥–∞–π –∑–∞–¥–∞—á—É" | 15-18s | task_create |

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π (Phase 1: Conditional Reflection)

| –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ | –ù–æ–≤–æ–µ –≤—Ä–µ–º—è | –£–ª—É—á—à–µ–Ω–∏–µ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|-------------|-------------|-----------|-----------|
| "–ü–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á–∏" | **5-7s** | **-10-11s (60% ‚úÖ)** | Skip reflection |
| "–£–¥–∞–ª–∏ –∑–∞–¥–∞—á—É X" | 18-22s | -2-3s (12%) | Reflection —Ç–æ–ª—å–∫–æ –Ω–∞ delete |
| "–°–æ–∑–¥–∞–π –∑–∞–¥–∞—á—É" | **5-7s** | **-10-11s (60% ‚úÖ)** | Skip reflection |

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π (Phase 2: + Claude Haiku)

| –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ | –ù–æ–≤–æ–µ –≤—Ä–µ–º—è | –£–ª—É—á—à–µ–Ω–∏–µ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|-------------|-------------|-----------|-----------|
| "–ü–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á–∏" | **3-5s** | **-12-13s (70% ‚úÖ)** | Skip reflection + fast planning |
| "–£–¥–∞–ª–∏ –∑–∞–¥–∞—á—É X" | 12-15s | -8-10s (40%) | Fast planning |
| "–°–æ–∑–¥–∞–π –∑–∞–¥–∞—á—É" | **3-5s** | **-12-13s (70% ‚úÖ)** | Skip reflection + fast planning |

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π (Phase 3: + Ollama –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö)

| –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ | –ù–æ–≤–æ–µ –≤—Ä–µ–º—è | –£–ª—É—á—à–µ–Ω–∏–µ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|-------------|-------------|-----------|-----------|
| "–ü–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á–∏" | **2-3s** | **-13-15s (80% ‚úÖ)** | Local LLM + no reflection |
| "–£–¥–∞–ª–∏ –∑–∞–¥–∞—á—É X" | 10-12s | -10-13s (50%) | Hybrid routing |
| "–°–æ–∑–¥–∞–π –∑–∞–¥–∞—á—É" | **2-3s** | **-13-15s (80% ‚úÖ)** | Local LLM + no reflection |

---

## ü§î –°—Ç–æ–∏—Ç –ª–∏ –º–µ–Ω—è—Ç—å –º–æ–¥–µ–ª—å?

### –¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å: Google Gemini 2.5 Flash

**–ü–ª—é—Å—ã**:
- ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–∞—è (~3-4s)
- ‚úÖ –û—á–µ–Ω—å –¥–µ—à—ë–≤–∞—è ($0.075/$0.30)
- ‚úÖ –û–≥—Ä–æ–º–Ω—ã–π context window (1M tokens)
- ‚úÖ –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ

**–ú–∏–Ω—É—Å—ã**:
- ‚ö†Ô∏è –ù–µ —Å–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è (–µ—Å—Ç—å –±—ã—Å—Ç—Ä–µ–µ –Ω–∞ 30-40%)
- ‚ö†Ô∏è –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç prompt caching
- ‚ö†Ô∏è –°–µ—Ç–µ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —á–µ—Ä–µ–∑ OpenRouter

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã

#### 1. Claude 3.5 Haiku (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è planning)

**–°–∫–æ—Ä–æ—Å—Ç—å**: ‚ö°‚ö°‚ö°‚ö° (1.5-2s)
**–ö–∞—á–µ—Å—Ç–≤–æ**: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
**–°—Ç–æ–∏–º–æ—Å—Ç—å**: üí∞üí∞üí∞ ($0.80/$4.00)

```
‚úÖ –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –¥–ª—è planning_provider
‚ö†Ô∏è –î–æ—Ä–æ–∂–µ, –Ω–æ –Ω–∞–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç prompt caching
```

#### 2. GPT-4o Mini

**–°–∫–æ—Ä–æ—Å—Ç—å**: ‚ö°‚ö°‚ö° (2-3s)
**–ö–∞—á–µ—Å—Ç–≤–æ**: ‚≠ê‚≠ê‚≠ê‚≠ê
**–°—Ç–æ–∏–º–æ—Å—Ç—å**: üí∞üí∞ ($0.15/$0.60)

```
‚úÖ –°—Ä–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç
‚úÖ –î–µ—à–µ–≤–ª–µ Haiku
‚ö†Ô∏è –ù–µ –Ω–∞–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ Gemini
```

#### 3. Ollama Llama 3.2 3B (–¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)

**–°–∫–æ—Ä–æ—Å—Ç—å**: ‚ö°‚ö°‚ö°‚ö°‚ö° (0.5-1s)
**–ö–∞—á–µ—Å—Ç–≤–æ**: ‚≠ê‚≠ê‚≠ê (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è simple)
**–°—Ç–æ–∏–º–æ—Å—Ç—å**: üí∞ FREE

```
‚úÖ –°–ê–ú–ê–Ø –ë–´–°–¢–†–ê–Ø
‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è
‚úÖ –ù–µ—Ç —Å–µ—Ç–µ–≤–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏
‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É
‚ö†Ô∏è –ö–∞—á–µ—Å—Ç–≤–æ –Ω–∏–∂–µ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á
```

### üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```bash
# .env - –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥
LLM_PROVIDER=openrouter

# –ë—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å –¥–ª—è planning
ANTHROPIC_API_KEY=sk-ant-...
ANTHROPIC_DEFAULT_MODEL=claude-3-5-haiku-20241022

# –î–µ—à—ë–≤–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ
OPENROUTER_API_KEY=sk-or-...
OPENROUTER_DEFAULT_MODEL=google/gemini-2.5-flash

# –õ–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_DEFAULT_MODEL=llama3.2:3b
ENABLE_OLLAMA_FALLBACK=true

# Routing
ROUTER_PLANNING_PROVIDER=anthropic      # ‚Üê Haiku (–±—ã—Å—Ç—Ä–æ)
ROUTER_STRUCTURING_PROVIDER=openrouter  # ‚Üê Gemini (–¥–µ—à—ë–≤–æ)
ROUTER_DEFAULT_PROVIDER=openrouter      # ‚Üê Gemini (fallback)
```

**–≠—Ñ—Ñ–µ–∫—Ç**: –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç—å/–∫–∞—á–µ—Å—Ç–≤–æ/—Å—Ç–æ–∏–º–æ—Å—Ç—å

---

## üìù –í—ã–≤–æ–¥—ã

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ ‚úÖ

1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: Event-driven design –æ—Ç–ª–∏—á–Ω—ã–π, –Ω–µ—Ç —É–∑–∫–∏—Ö –º–µ—Å—Ç
2. **Tool execution**: –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (<0.01s)
3. **Memory management**: SQLite –±—ã—Å—Ç—Ä—ã–π (<0.01s)
4. **Verification**: –õ—ë–≥–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ LLM

### –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚ö†Ô∏è

1. **Reflection**: –ó–∞–Ω–∏–º–∞–µ—Ç 50% –≤—Ä–µ–º–µ–Ω–∏, —á–∞—Å—Ç–æ –Ω–µ –Ω—É–∂–µ–Ω
2. **Dynamic replanning**: –£–º–Ω–æ–∂–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ LLM –≤—ã–∑–æ–≤–æ–≤
3. **–°–µ—Ç–µ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞**: OpenRouter API adds latency
4. **–ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**: –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –ø—Ä–æ–º–ø—Ç—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑

### –ì–ª–∞–≤–Ω—ã–π –≤—ã–≤–æ–¥ üéØ

**–ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ –º–æ–¥–µ–ª–∏** (Gemini 2.5 Flash –æ—Ç–ª–∏—á–Ω–∞—è –º–æ–¥–µ–ª—å), **–ø—Ä–æ–±–ª–µ–º–∞ –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ LangGraph**:
- Reflection –≤–∫–ª—é—á–µ–Ω –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (–Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è read-only)
- Dynamic replanning —Å–æ–∑–¥–∞—ë—Ç –ª–∏—à–Ω–∏–µ —Ü–∏–∫–ª—ã
- –ù–µ—Ç conditional routing based on operation type

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç #1**: –°–¥–µ–ª–∞—Ç—å Reflection —É—Å–ª–æ–≤–Ω—ã–º (50-75% —É—Å–∫–æ—Ä–µ–Ω–∏–µ)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç #2**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Claude Haiku –¥–ª—è planning (–µ—â—ë +20% —É—Å–∫–æ—Ä–µ–Ω–∏–µ)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç #3**: –î–æ–±–∞–≤–∏—Ç—å Ollama –¥–ª—è simple queries (–µ—â—ë +30% —É—Å–∫–æ—Ä–µ–Ω–∏–µ)

**–ò—Ç–æ–≥–æ–≤–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ**: –û—Ç **15-25s** –¥–æ **2-5s** (–≤ 5-10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ! üöÄ)

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [Telegram Integration Architecture](../architecture/telegram-integration.md)
- [LangGraph LLM Integration](../architecture/langgraph-llm-integration.md)
- [Previous Performance Analysis](./PERFORMANCE-ANALYSIS.md)

---

---

## ‚úÖ –û–ë–ù–û–í–õ–ï–ù–ò–ï: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞!

**–î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**: 2025-10-10

### –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

1. ‚úÖ **Conditional Reflection —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)
   - –§–∞–π–ª: `src/kira/agent/graph.py`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π (safe/destructive/moderate)
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —É–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ `should_reflect()`
   - –û–±–Ω–æ–≤–ª—ë–Ω `route_after_plan()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Å–ª–æ–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π

2. ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞**
   - –§–∞–π–ª: `docs/architecture/conditional-reflection.md`
   - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–∞–±–æ—Ç—ã
   - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

| –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –£–ª—É—á—à–µ–Ω–∏–µ |
|-------------|------|-------|-----------|
| "–ü–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á–∏" | 15-18s | **5-7s** | **-60%** üöÄ |
| "–°–æ–∑–¥–∞–π –∑–∞–¥–∞—á—É" | 15-18s | **7-10s** | **-40%** ‚ö° |
| "–£–¥–∞–ª–∏ –∑–∞–¥–∞—á—É" | 20-25s | **15-20s** | **-25%** ‚úÖ |

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è):

1. üß™ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
2. üìä –°–æ–±—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
3. ‚ö° –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Claude Haiku –¥–ª—è planning
4. üí° –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å Ollama –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

**–ê–≤—Ç–æ—Ä**: AI Assistant
**–î–∞—Ç–∞**: 2025-10-10
**–í–µ—Ä—Å–∏—è**: 1.1 (—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π)

